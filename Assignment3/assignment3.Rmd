---
title: "R Notebook"
output: html_notebook
---

```{r}
library(ggplot2)
library(magrittr)
library(tidyverse)
```

# Read data

```{r}
# setwd("/Users/joergensen/Documents/DTU_Mat_Tek/4.semester/02417_TimeSeriesAnalysis/Assignment_3_Laws")
data <- read.csv(file = 'DataAssignment3.csv')
parti_color=data$Government
parti_color[data$Government=="Social Democrats"]='#b02424'
parti_color[data$Government=="Venstre"]='#304c74'
parti_color[data$Government=="Conservative"]='#90a424'
parti_color[data$Government=="Social Liberals"]='green'
parti_color[data$Government=="Independent"]='yellow'
head(data)
```

## Plot data

```{r}
(plot <- ggplot(data = data)+
  geom_point(aes(x=Date,y=NumberWords))+
  geom_rect(data=data,aes(xmin = Date, xmax = Date+1,
                 ymin = -Inf, ymax = Inf,fill=Government),alpha=0.55)+
  geom_point(aes(x=Date,y=NumberWords))+
  geom_line(aes(x=Date,y=NumberWords)))

# plot

```


## Transform data

```{r}
diff_order <- 2

data2 <- data %>%
  mutate(NumberWordsTrans = data %>% .$NumberWords %>% log() %>%  diff(differences = diff_order) %>% c(rep(NA, diff_order), .)) %>% 
  # caret::dummyVars()
  mutate(Conservative = Government == "Conservative" %>% replace(TRUE, 1) %>% replace(FALSE, 0)) %>%
  mutate(Independent = Government == "Independent") %>%
  mutate("Social Democrates" = Government == "Social Democrats") %>%
  mutate("Social Liberals" = Government == "Social Liberals") %>%
  mutate(Venstre = Government == "Venstre") 
data2

# data$Government == "Conservative" %>% as.vector() %>% as.logical() %>%  as.integer()
  # sapply(FUN = as.integer)
# as.integer(T)
```

## Plot transformed data

```{r}
(plot <- ggplot(data = data)+
  geom_point(aes(x=Date,y=NumberWordsTrans))+
  geom_rect(data=data,aes(xmin = Date, xmax = Date+1,
                 ymin = -Inf, ymax = Inf,fill=Government),alpha=0.55)+
  geom_point(aes(x=Date,y=NumberWordsTrans))+
  geom_line(aes(x=Date,y=NumberWordsTrans)))
```

```{r}
data %>% 
  filter(!is.na(NumberWordsTrans)) %>%  
  .$NumberWordsTrans %>% 
  acf()
```



```{r}
data
# one-hot encode data

```



# MARIMA

```{r}
model = marima::define.model(kvar = ncol(data), ar=0, ma=1, rem.var=c(1:3), reg.var = c(5:9), indep=NULL)
marima::marima(t(data), ar.pattern=model$ar.pattern, ma.pattern=model$ma.pattern)
```

```{r}
# optimal marima parameters for data

```




























