---
title: "Assignment 2)  ARMA Processes and Seasonal Processes"
output: html_notebook
---

# Initialize
```{r}
rm(list = ls());
graphics.off();
cat("\014");
knitr::opts_chunk$set(echo = TRUE)
library(magrittr)
library(ggplot2)
library(dplyr)
library(forecast)
```

# Question 2.2
```{r}
t <- c("2015Q2", "2015Q3", "2015Q4", "2016Q1", "2016Q2", "2016Q3", "2016Q4", "2017Q1")
CPI <- c(237.9, 236.5, 238.1, 241, 241.4, 241.4, 243.8, 245.0)

df <- data.frame(t, CPI)
df

```
```{r}
library(xtable)
```


# Question 2.4
(mixed) seasonal model (p, 0, q)Ã—(P, 0, Q)
```{r}
set.seed(123)
#2.4.1
layout(matrix(c(1,1,2,3), 2, 2, byrow = TRUE))
sim1 = arima.sim(model=list(ar=c(0.8)),n=200)
plot(sim1,ylab='Y_t')
acf(sim1,lag.max = 50, main=NA, panel.first = abline(v=c(12*(1:(200/12))), lty=2, col='blue'))
pacf(sim1,lag.max = 50, main=NA, panel.first = abline(v=c(12*(1:(200/12))),lty=2, col='blue'))
```




## With portes library


### Model 1: AR(1)

```{r}
Y = portes::varima.sim(n=5000, model = list(ar = -0.8, period = 12))

pdf("arma1_process.pdf")
# expression(paste("Realisation of a ", "(1,0,0)", x, "(0,0,0)"[12], " seasonal process with ", phi[1], " = -0.8"))
plot(Y[1:100], ylab= expression(Y[t]), xlab = "Time", main = "Realization of stochastic process", type = "l")

pdf("arma1_acf.pdf")
par(mfrow=c(1,2))

acf(Y,main="ACF")
pacf(Y,main="PACF", ylim = c(0.1, -0.1))

dev.off()
```


### Model 2: seasonal AR(1)

```{r}
Y = portes::varima.sim(n=5000, model = list(sar = 0.8, period = 12))

pdf("arma2_process.pdf")
# expression(paste("Realisation of a ", "(0,0,0)", x, "(1,0,0)"[12], " seasonal process with ", Phi[1], " = 0.8"))
plot(Y[1:100], ylab= expression(Y[t]), xlab = "Time", main = "Realization of stochastic process", type = "l")

pdf("arma2_acf.pdf")
par(mfrow=c(1,2))

acf(Y,main="ACF")
pacf(Y,main="PACF")

dev.off()
```


### Model 3: AR(1) with seasonal MA(1)

```{r}
Y = portes::varima.sim(n=5000, model = list(ar = -0.9, sma = 0.7, period = 12))

pdf("arma3_process.pdf")
# expression(paste("Realisation of a ", "(1,0,0)", x, "(0,0,1)"[12], " seasonal process with ", phi[1], " = -0.9 and ", Theta[1], " = 0.7"))
plot(Y[1:100], ylab= expression(Y[t]), xlab = "Time", main = "Realization of stochastic process", type = "l")

pdf("arma3_acf.pdf")
par(mfrow=c(1,2))

acf(Y,main="ACF")
pacf(Y,main="PACF", ylim = c(-0.5, 0.2))

dev.off()
```

### Model 4: AR(1) and seasonal AR(1) 

```{r}
Y = portes::varima.sim(n=5000, model = list(ar = 0.6, sar = 0.8, period = 12))

pdf("arma4_process.pdf")
#  expression(paste("Realisation of a ", "(1,0,0)", x, "(1,0,0)"[12], " seasonal process with ", phi[1], " = 0.6 and ", Phi[1], " = 0.8"))
plot(Y[1:100], ylab= expression(Y[t]), xlab = "Time", main = "Realization of stochastic process", type = "l")

pdf("arma4_acf.pdf")
par(mfrow=c(1,2))

acf(Y,main="ACF")
pacf(Y,main="PACF")

dev.off()
```

### Model 5: MA(1) and seasonal MA(1)

```{r}
Y = portes::varima.sim(n=5000, model = list(ma = -0.4, sma = 0.8, period = 12))

pdf("arma5_process.pdf")
# expression(paste("Realisation of a ", "(0,0,1)", x, "(0,0,1)"[12], " seasonal process with ", theta[1], " = -0.8 and ", Theta[1], " = 0.8"))
plot(Y[1:100], ylab= expression(Y[t]), xlab = "Time", main = "Realization of stochastic process", type = "l")

pdf("arma5_acf.pdf")
par(mfrow=c(1,2))

acf(Y,main="ACF", ylim = c(-.5, .5))
pacf(Y,main="PACF")

dev.off()
```


### Model 6: MA(1) with seasonal AR(1)

```{r}
Y = portes::varima.sim(n=5000, model = list(ma = 0.4, sar = -0.7, period = 12))

pdf("arma6_process.pdf")
# par(mfrow = c(3,1))
# expression(paste("Realisation of a ", "(0,0,1)", x, "(1,0,0)"[12], " seasonal process \n with ", theta[1], " = 0.4 and ", Phi[1], "=-0.7"))
plot(Y[1:100], ylab= expression(Y[t]), xlab = "Time", main = "Realization of stochastic process", type = "l")

pdf("arma6_acf.pdf")
par(mfrow=c(1,2))

acf(Y,main="ACF")
pacf(Y,main="PACF")


dev.off()
```


```{r}
Y[1:1000]
```

